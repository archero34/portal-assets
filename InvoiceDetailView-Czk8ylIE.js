import{_ as I,b as f,c as w,A as S,d as ee,i as te,r as v,f as ae,o as oe,j as l,k as m,q as e,v as z,x as T,y as C,F as se,B as ie,z as ne,l as le,m as B,s as p,L as ce,C as re,D as de}from"./index-njxYMIA0.js";import{B as ue,_ as me,T as ve,I as pe}from"./transactionFormUseCases-DyXKRKVB.js";import{P as _e}from"./PageView-BfH8tsmj.js";import{_ as be,B as fe}from"./BlueCollarContent-OVW-PlcV.js";import{B as he,a as R,I as ye,b as ge}from"./BlueCollarModal-BuahIIZF.js";import{d as xe,i as we}from"./index-CS5tPIud.js";import"./BlueCollarInput-Bbfj4CwT.js";import"./BlueCollarBadge-QXQIXcG4.js";const Ce="data:image/svg+xml,%3csvg%20width='20'%20height='24'%20viewBox='0%200%2020%2024'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='vuesax/linear/arrow-left'%3e%3cg%20id='arrow-left'%3e%3cpath%20id='Vector'%20d='M12.5%2016.6L7.0667%2011.1667C6.42503%2010.525%206.42503%209.47503%207.0667%208.83336L12.5%203.40002'%20stroke='%239AA4B2'%20stroke-width='1.5'%20stroke-miterlimit='10'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",Ie={},ke={src:Ce,alt:"Arrow Left"};function Fe(r,h){return f(),w("img",ke)}const Ve=I(Ie,[["render",Fe]]),Ne="data:image/svg+xml,%3csvg%20width='20'%20height='20'%20viewBox='0%200%2020%2020'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20id='vuesax/linear/wallet'%3e%3cg%20id='wallet'%3e%3cpath%20id='Vector'%20d='M10.55%202.09841L10.525%202.15674L8.1083%207.76507H5.7333C5.16663%207.76507%204.62497%207.88174%204.1333%208.09007L5.59163%204.60674L5.62497%204.52341L5.6833%204.39007C5.69997%204.34007%205.71663%204.29007%205.74163%204.24841C6.8333%201.72341%208.06663%201.14841%2010.55%202.09841Z'%20stroke='%23FCFCFD'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20id='Vector_2'%20d='M15.0417%207.93172C14.6667%207.81506%2014.2667%207.76506%2013.8667%207.76506H8.1084L10.5251%202.15672L10.5501%202.09839C10.6751%202.14006%2010.7917%202.19839%2010.9167%202.24839L12.7584%203.02339C13.7834%203.44839%2014.5001%203.89006%2014.9334%204.42339C15.0167%204.52339%2015.0834%204.61506%2015.1417%204.72339C15.2167%204.84006%2015.2751%204.95672%2015.3084%205.08172C15.3417%205.15672%2015.3667%205.23172%2015.3834%205.29839C15.6084%205.99839%2015.4751%206.85672%2015.0417%207.93172Z'%20stroke='%23FCFCFD'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20id='Vector_3'%20d='M17.9348%2011.8319V13.4569C17.9348%2013.6236%2017.9265%2013.7903%2017.9182%2013.9569C17.7598%2016.8653%2016.1348%2018.3319%2013.0515%2018.3319H6.55151C6.35151%2018.3319%206.15151%2018.3153%205.95985%2018.2903C3.30985%2018.1153%201.89318%2016.6986%201.71818%2014.0486C1.69318%2013.8569%201.67651%2013.6569%201.67651%2013.4569V11.8319C1.67651%2010.1569%202.69318%208.71526%204.14318%208.09026C4.64318%207.88193%205.17651%207.76526%205.74318%207.76526H13.8765C14.2848%207.76526%2014.6848%207.82359%2015.0515%207.93193C16.7098%208.44026%2017.9348%209.99026%2017.9348%2011.8319Z'%20stroke='%23FCFCFD'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20id='Vector_4'%20d='M5.59175%204.60681L4.13341%208.09014C2.68341%208.71514%201.66675%2010.1568%201.66675%2011.8318V9.39015C1.66675%207.02348%203.35008%205.04848%205.59175%204.60681Z'%20stroke='%23FCFCFD'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3cpath%20id='Vector_5'%20d='M17.9322%209.38975V11.8314C17.9322%209.99809%2016.7155%208.43975%2015.0488%207.93975C15.4822%206.85642%2015.6072%206.00642%2015.3988%205.29809C15.3822%205.22309%2015.3572%205.14809%2015.3238%205.08142C16.8738%205.88142%2017.9322%207.52309%2017.9322%209.38975Z'%20stroke='%23FCFCFD'%20stroke-width='1.5'%20stroke-linecap='round'%20stroke-linejoin='round'/%3e%3c/g%3e%3c/g%3e%3c/svg%3e",Se={},Te={src:Ne,alt:"Wallet"};function Be(r,h){return f(),w("img",Te)}const Le=I(Se,[["render",Be]]),Ae={},Ee={class:"wrapper"};function Pe(r,h){return f(),w("div",Ee,[S(r.$slots,"header",{},void 0,!0),S(r.$slots,"content",{},void 0,!0),S(r.$slots,"footer",{},void 0,!0)])}const $e=I(Ae,[["render",Pe],["__scopeId","data-v-a86c507a"]]),_=r=>(re("data-v-f67ecc3d"),r=r(),de(),r),Me={class:"card-wrapper p-3"},De={class:"invoice-header-wrapper"},je={class:"invoice-info-wrapper"},He={class:"invoice-icon-wrapper"},Oe=_(()=>e("span",{class:"bc-text bc-text-gray-25 bc-fs-20"},"Invoice",-1)),Ue={class:"invoice-title-wrapper"},ze={class:"bc-text bc-text-gray-25 bc-fs-32 m-0 p-0"},Re={class:"bc-text bc-lh-20 bc-text-gray-25 bc-fs-16 m-0 p-0"},Ze={class:"invoice-right-wrapper"},Ye={class:"invoice-summary-wrapper"},Ge=_(()=>e("span",{class:"bc-text bc-text-gray-25 bc-fw-700 invoice-summary-header"},"SUMMARY",-1)),Je={id:"subtotal",class:"d-flex justify-content-between bc-text bc-fw-500 bc-text-gray-25 gap-3"},We=_(()=>e("span",null,"Subtotal",-1)),qe=_(()=>e("div",{class:"summary-divider"},null,-1)),Ke={id:"total",class:"d-flex justify-content-between bc-text bc-fw-500 bc-text-gray-25 gap-3"},Qe=_(()=>e("span",null,"Total",-1)),Xe={class:"paid-info-wrapper"},et={id:"youpaid",class:"youpaid-info bc-text bc-fw-500 bc-text-gray-25"},tt={class:"icon-text"},at=_(()=>e("span",null,"You paid",-1)),ot={id:"amountTopaid",class:"amountpaid-info bc-text bc-fw-500 bc-text-gray-25"},st={class:"amountpaid-item"},it={class:"icon-text"},nt=_(()=>e("span",null,"Amount to be paid",-1)),lt={key:0,class:"invoice-footer-wrapper"},ct={class:"invoice-footer-head bc-text bc-text-gray-modern-800 bc-fw-500"},rt={class:"container-fluid py-2",id:"invoice-item"},dt={class:"card"},ut={class:"card-body"},mt=_(()=>e("span",{class:"bc-text bc-text-gray-800 bc-fs-16 bc-fw-600 text-center"}," Payment made successfully ",-1)),vt=_(()=>e("span",{class:"bc-text bc-text-gray-500 text-center"}," Your payment has been processed successfully, we will now redirect you to the invoice ",-1)),pt=ee({__name:"InvoiceDetailView",setup(r){const{params:h}=ie(),Z=ne(),{setAlert:k}=te(),{getTransactionForm:Y}=new ve,{getInvoiceById:G,printInvoice:J}=new pe,F=v([]),b=v([]),o=ae({documentNumber:"",customerName:"",summary:{subtotal:{text:"0.00",value:0},total:{text:"0.00",value:0},amountpaid:{text:"0.00",value:0}}}),W=v(xe),y=v(0),d=v(!1),V=v([]),L=v([]),q=window.innerHeight*.48,x=v(!1),A=v(!1),K=()=>{Z.back()},E=async(i,a)=>{const{invoice:c,errors:s}=await G(i,a.value);if(s.value.length>0)console.error("Error loading invoice",s.value),k(),d.value=!1;else return c},P=async()=>{const{transactionForm:i,errors:a}=await Y("INVOICE");if(a.value.length>0)console.error("Error loading invoice transaction form",a.value),k(),d.value=!1;else return i},$=async()=>{var i,a;if(x.value=!x.value,!x.value){d.value=!0;const c=await P();c.value.groups.push({label:"UI_INJECTED_FIELDS",visible:!1,fields:[{id:"subtotal",label:"Subtotal",visible:!1},{id:"total",label:"Total",visible:!1},{id:"amountpaid",label:"Amount Paid",visible:!1}]});const s=await E(h.invoiceId,c);o.summary.amountpaid.text=((i=s.value.bodyFields.find(g=>g.id==="amountpaid"))==null?void 0:i.text)??"0.00",o.summary.amountpaid.value=((a=s.value.bodyFields.find(g=>g.id==="amountpaid"))==null?void 0:a.value)??0,d.value=!1}},Q=async()=>{d.value=!0;const i=h.invoiceId,{url:a,errors:c}=await J(i);if(c.value.length>0)console.error("Error Printing Invoice:",c.value),k();else{window.open(a,"_blank");const s=document.createElement("a");s.href=a,s.setAttribute("download",`Invoice_${i}.pdf`),document.body.appendChild(s),s.click(),document.body.removeChild(s)}d.value=!1};return oe(async()=>{var s,g,M,D,j,H,O,U;d.value=!0;const i=await P();i.value.groups.push({label:"UI_INJECTED_FIELDS",visible:!1,fields:[{id:"subtotal",label:"Subtotal",visible:!1},{id:"total",label:"Total",visible:!1},{id:"amountpaid",label:"Amount Paid",visible:!1}]});const a=await E(h.invoiceId,i);F.value=i.value.groups.map(t=>({...t,fields:t.fields.filter(u=>u.visible).map(u=>{const n=a.value.bodyFields.find(N=>N.id===u.id);return{...u,value:n==null?void 0:n.value,text:n==null?void 0:n.text}})})),b.value=i.value.tabs.map(t=>({...t,groups:t.groups.map(u=>({...u,fields:u.fields.filter(n=>n.visible)}))})),o.documentNumber=((s=a.value.bodyFields.find(t=>t.id==="tranid"))==null?void 0:s.text)??"",o.customerName=((g=a.value.bodyFields.find(t=>t.id==="entity"))==null?void 0:g.text)??"",o.summary.subtotal.text=((M=a.value.bodyFields.find(t=>t.id==="subtotal"))==null?void 0:M.text)??"0.00",o.summary.subtotal.value=((D=a.value.bodyFields.find(t=>t.id==="subtotal"))==null?void 0:D.value)??0,o.summary.total.text=((j=a.value.bodyFields.find(t=>t.id==="total"))==null?void 0:j.text)??"0.00",o.summary.total.value=((H=a.value.bodyFields.find(t=>t.id==="total"))==null?void 0:H.value)??0,o.summary.amountpaid.text=((O=a.value.bodyFields.find(t=>t.id==="amountpaid"))==null?void 0:O.text)??"0.00",o.summary.amountpaid.value=((U=a.value.bodyFields.find(t=>t.id==="amountpaid"))==null?void 0:U.value)??0,y.value=b.value.findIndex(t=>t.id==="TRANSACTIONITEMS");const c=b.value[y.value].groups.findIndex(t=>t.label==="Items");V.value=b.value[y.value].groups[c].fields.map(t=>({title:t.label,key:t.id})),L.value=a.value.itemFields.map(t=>t.reduce((u,n)=>{const N=V.value.findIndex(X=>X.key===n.id);return n.id&&N!=-1&&(u[n.id]=n.text??n.value),u},{})),d.value=!1}),(i,a)=>{const c=le("v-data-table");return f(),w(se,null,[l(_e,{type:"primary",iconCallback:K},{icon:m(()=>[e("span",null,[l(Ve)])]),pagename:m(()=>[B("Invoice #"+p(o.documentNumber),1)]),subtitle:m(()=>[B(p(o.customerName),1)]),actions:m(()=>[l(R,{text:"Print Invoice",type:"secondary",callback:Q},{icon:m(()=>[l(be)]),_:1}),o.summary.total.value!==o.summary.amountpaid.value?(f(),T(R,{key:0,text:"Pay Invoice",type:"primary",callback:$},{icon:m(()=>[l(Le)]),_:1})):C("",!0)]),_:1}),e("div",Me,[l($e,null,{header:m(()=>[e("div",De,[e("div",je,[e("div",He,[e("span",null,[l(me,{type:"light"})]),Oe]),e("div",Ue,[e("h2",ze," INVOICE #"+p(o.documentNumber),1),e("span",Re,p(o.customerName),1)])]),e("div",Ze,[e("div",Ye,[Ge,e("div",Je,[We,e("span",null,p(o.summary.subtotal.text),1)]),qe,e("div",Ke,[Qe,e("span",null,p(o.summary.total.text),1)])]),e("div",Xe,[e("div",et,[e("div",tt,[l(ye,{class:"icon-size"}),B(),at]),e("span",null,p(o.summary.amountpaid.text),1)]),e("div",ot,[e("div",st,[e("div",it,[l(ge,{class:"icon-size"}),nt]),e("span",null,p((o.summary.total.value-o.summary.amountpaid.value).toFixed(2)),1)])])])])])]),content:m(()=>[F.value.length>0?(f(),T(fe,{key:0,items:F.value},null,8,["items"])):C("",!0)]),footer:m(()=>[b.value.length>0&&b.value[y.value].id==="TRANSACTIONITEMS"&&b.value[y.value].visible?(f(),w("div",lt,[e("div",ct,p(b.value[y.value].label),1),e("section",rt,[e("div",dt,[e("div",ut,[l(c,{headers:V.value,items:L.value,height:q,loading:d.value,"loading-text":"Loading items...","multi-sort":"","items-per-page":W.value,"items-per-page-options":z(we)},null,8,["headers","items","loading","items-per-page","items-per-page-options"])])])])])):C("",!0)]),_:1})]),l(ue,{modelValue:x.value,"onUpdate:modelValue":a[0]||(a[0]=s=>x.value=s),amountDetails:o.summary,onOnClose:$,invoiceId:z(h).invoiceId},null,8,["modelValue","amountDetails","invoiceId"]),l(he,{type:"primary",modelValue:A.value,"onUpdate:modelValue":a[1]||(a[1]=s=>A.value=s)},{content:m(()=>[mt,vt]),_:1},8,["modelValue"]),d.value?(f(),T(ce,{key:0})):C("",!0)],64)}}}),Ct=I(pt,[["__scopeId","data-v-f67ecc3d"]]);export{Ct as default};
